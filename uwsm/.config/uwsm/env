#!/usr/bin/env bash

# --- XDG Base Directory ---
export XDG_DATA_HOME="${XDG_DATA_HOME:-$HOME/.local/share}"
export XDG_CONFIG_HOME="${XDG_CONFIG_HOME:-$HOME/.config}"
export XDG_STATE_HOME="${XDG_STATE_HOME:-$HOME/.local/state}"
export XDG_CACHE_HOME="${XDG_CACHE_HOME:-$HOME/.cache}"

# --- Application Redirects ---
export CARGO_HOME="${CARGO_HOME:-$XDG_DATA_HOME/cargo}"
export RUSTUP_HOME="${RUSTUP_HOME:-$XDG_DATA_HOME/rustup}"
export GNUPGHOME="${GNUPGHOME:-$XDG_DATA_HOME/gnupg}"
export PYTHONHISTORY="${PYTHONHISTORY:-$XDG_STATE_HOME/python/history}"

# --- Development Tools ---
export DOTNET_CLI_HOME="$XDG_DATA_HOME/dotnet"
export NUGET_PACKAGES="$XDG_DATA_HOME/nuget/packages"
export PARALLEL_HOME="$XDG_CONFIG_HOME/parallel"
export NPM_CONFIG_USERCONFIG="$XDG_CONFIG_HOME/npm/npmrc"
export GOPATH="${XDG_DATA_HOME:-$HOME/.local/share}/go"

# Toolkit & Theming
export QT_QPA_PLATFORMTHEME="qt6ct"
export QT_QPA_PLATFORM="wayland;xcb"
export ADW_DISABLE_PORTAL=1

# Hardware Specifics
if [[ -d "/sys/module/nvidia" ]]; then
    export LIBVA_DRIVER_NAME=nvidia            # Hardware Video Acceleration
    export __GLX_VENDOR_LIBRARY_NAME=nvidia    # OpenGL Routing
    export GBM_BACKEND=nvidia-drm              # The Wayland Handshake
    
    # Explicitly enable G-Sync and VRR
    export __GL_GSYNC_ALLOWED=1
    export __GL_VRR_ALLOWED=1
fi
